<div class="container mb-4">
  <div class="game-actions">
    <%= link_to league_path(@game.season_league), class: 'btn btn-outline-secondary mr-4' do %>
      <i class="fas fa-angle-left"></i> Back to League
    <% end %>
    <% if policy(@game).destroy? %>
      <%= button_to 'Delete game', @game, class: 'btn btn-outline-danger mr-2', method: :delete %>
      <%= link_to 'Edit game', edit_game_path(@game), class: 'btn btn-outline-secondary mr-4' %>
    <% end %>
  </div>
  <div class="game-show__info mt-4">
    <div class="league-show__league-name">
      <h2><%= @game.league_name %></h2>
      <div class="league-show__location text-dark">
        <%= @game.league_location %>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-md-8">
        <div class="game-show__overview-stats">
          <h4>Game Overview</h4>
          <small class="text-muted">Game #10 of Season #3</small>
          <hr>
          <div class="row">
            <div class="col-md-6">
              <b>Date & Time:</b> <%= @game.full_date_and_time(@game.date) %><br />
              <b>Address:</b> <%= @game.address %><br />
              <b>Rebuys:</b> <%= @game.rebuy_text %><br />
            </div>
            <div class="col-md-6">
              <b>Buy in:</b> <%= @game.buy_in_text %><br />
              <%= @game.player_text %><br />
              <%= @game.pot_text %>
            </div>
          </div>
        </div>

        <div class="game-show__overview-standings mt-4">
          <h4>Game Standings</h4>
          <table class="table table-striped table-responsive-md">
            <thead class="thead-dark">
              <tr>
                <% if @game.not_completed? %>
                  <th scope="col"></th>
                <% end %>
                <th scope="col">#</th>
                <th scope="col">Player</th>
              </tr>
            </thead>
            <tbody>
              <% if @game.players.any? %>
                <% @game.saved_players.each_with_index do |player, index| %>
                  <tr class="game-standing">
                    <% if @game.not_completed? %>
                      <td class="up-down-button">
                        <%= button_to '#', class: 'btn', disabled: index.zero? do %>
                          <i class="fas fa-angle-up"></i>
                        <% end %>
                        <%= button_to '#', class: 'btn', disabled: player == @game.saved_players.last do %>
                          <i class="fas fa-angle-down"></i>
                        <% end %>
                      </td>
                    <% end %>
                    <th scope="row"><%= player.order_in_place(index, @game.players_count) %></th>
                    <td class="grow"><%= player.user_full_name %></td>
                  </tr>
                <% end %>
              <% end %>
                <td colspan="3">
                  <%= form_for @player do |f| %>
                    <%= f.hidden_field :game_id, value: @player.game_id %>
                    <%= f.select :user_id, @game.available_players, { prompt: 'Choose a Player' }, class: 'form-control mb-1', id: 'player-select' %>
                    <%= f.submit 'Finish player' %>
                  <% end %>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
